image: microsoft/dotnet:latest

stages:
    - build
    - test
    - docker

variables:
    test: "Algoritmos.Tests"
    buildConfiguration: 'Release'

before_script:
    - "dotnet restore"

build:
    stage: build
    script:
        - "dotnet build"

test:
    stage: test
    script: 
        - "dotnet test"  

docker:
    stage: docker
    displayName: 'build docker image'
    script: 
        - "docker build -f Dockerfile -t $dockerId/$imageName ."
    
    displayName: 'login docker hub'
    script: 
        - "docker login -u $dockerId -p $pswd"
    
    displayName: 'push image docker hub'
    script: 
        - "docker push $dockerId/$imageName"
    